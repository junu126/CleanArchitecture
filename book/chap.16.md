# Chap.16 독립성

좋은 아키텍처는 다음을 지원해야 한다.

* 시스템의 유스케이스
* 시스템의 운영
* 시스템의 개발
* 시스템의 배포

## 유스케이스

시스템의 아키텍처는 시스템의 의도를 지원해야 한다는 뜻.

* 좋은 아키텍처가 행위를 지원하기 위해 할 수 있는 일 중에서 가장 중요한 사항은 행위를 명확히 하고 외부로 드러내며, 이를 통해 시스템이 지닌 의도를 아키텍처 수준에서 알아볼 수 있게 만드는 것 이다.

## 운영

아키텍처는 더 실질적이며 덜 피상적인 역할을 맡는다.

* 각 컴포넌트를 적절히 격리하여 유지하고 컴포넌트 간의 통신방식을 특정 형태로 제한하지 않는다면,

  시간이 지나 운영에 필요한 요구사항이 바뀌더라도 스레드, 프로세스, 서비스로 구성된 기술 스펙트럼 사이를 전환하는 일이 훨씬 쉬워질 것 이다.

## 개발

콘웨이의 법칙

→ 시스템을 설계하는 조직이라면 어디든지 그 조직의 의사소통 구조와 동일한 구조의 설계를 만들어 낼 것이다.

* 많은 팀으로 구성된 상황에서 개발을 해야할 때, 각 팀이 독립적으로 행동하기 편한 아키텍처를 반드시 확보해야한다.

## 배포

* 좋은 아키텍처라면 **즉각적인 배포**를 목표한다.

마스터 컴포넌트는 시스템 전체를 하나로 묶고, 각 컴포넌트를 올바르게 구동하도록 통합하고 관리.

시스템을 컴포넌트 단위로 분할 및 격리.

## 선택사항 열어놓기

좋은 아키텍처는 선택사항을 열어 둠으로써, 향후 시스템에 변경이 필요 할 때, 어떤 방향으로든 쉽게 변경할 수 있도록 한다.

## 계층 결합 분리

아키텍트는 **단일 책임 원칙과 공통 폐쇄 원칙**을 적용하여, 그 의도의 맥락에 따라서 분리하고 묶는다.

## 유스케이스 결합 분리

시스템의 수평적인 계층을 가로지르도록 자른, 수직으로 좁다란 조각이기도 하다. 각 유스케이스는 UI의 일부, 애플리케이션의 일부, 특화 업무 규칙의 일부, 애플리케이션 독립적 업무 규칙의 일부, 그리고 데이터베이스 기능의 일부를 사용한다.

→ 시스템을 수평적 계층으로 분할하면서 얇은 수직적인 유스케이스로 시스템을 분할.

## 결합 분리 모드

올바른 결합 분리는 서비스 운영에 도움이 된다.

* 운영 측면에서 결합 분리를 이용하려면 적절한 모드를 선택해야한다. \(컴포넌트를 서비스 단계까지도 나눌 수 있다.\)
* 실제 서비스에 기반한 아키텍처를 SOA \(service-oriented-arcchitecture\)라고 한다.
  * ex\) 마이크로서비스 등..

## 개발 독립성

컴포넌트가 완전히 분리되면 개발 팀도 거의 분리된다. → 아키텍처로 인한 구조적 뒷받침.

## 배포 독립성

유스케이스와 계층의 결합이 분리되면 배포 측면에서도 고도의 유연성이 생긴다.

* 실제로 결합을 재대로 분리한다면 운영 중인 시스템에서 계층 및 유스케이스를 교체할 수 있다.

## 중복

중복은 **진짜 중복**과 **우발적 중복**으로 나뉜다.

* 진짜 중복은 개발자라면 해결해야하는 중복이다.
* 우발적 중복은 중복 처럼 보이는 코드이다. \(아키텍처 관점\)

유스케이스를 분리할 때 우발적 중복이 발생한다. 이를 무시하면 안된다.

## 결합 분리 모드 \(다시\)

다시 결합 분리 모드로 돌아간다.

* 결합 분리 방법에는 여럿이 있다.
  * **소스 수준 분리 모드**: 소스 코드 모듈 사이의 의존성을 제어할 수 있다.
  * **배포 수준 분리 모드**: 배포 가능한 단위\(라이브러리 등\)사이의 의존성을 제어할 수 있다.
  * **서비스 수준 분리 모드:** 의존하는 수준을 데이터 구조 단위까지 낮출 수 있고, 순전히 네트워크 패킷을 통해 통신하도록 만들 수 있다.
* 현 시점에선 **서비스 수준 분리 모드**가 가장 인기 있어 보인다.
* 좋은 아키텍처라면 결합 분리 모드를 선택사항으로 남겨두고 배포 규모에 따라서 적합한 모드를 선택할 수 있게 만들어 준다.

## 결론

시스템의 결합 분리 모드는 시간이 지나면서 바뀌기 쉬우며, 뛰어난 아키텍트라면 이러한 변경을 예측하여 큰 무리 없이 반영 할 수 있도록 만들어야 한다.

